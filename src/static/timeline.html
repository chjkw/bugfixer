<!DOCTYPE html>
<html>
    <head>
        <title>Title</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="LOCAL_RESOURCE/uikit-3.8.0/css/uikit.css" />
        <script src="LOCAL_RESOURCE/uikit-3.8.0/js/uikit.min.js"></script>
        <script src="LOCAL_RESOURCE/uikit-3.8.0/js/uikit-icons.min.js"></script>
    </head>
    <body>
        <div class="uk-container uk-padding">
            <div class="uk-timeline" id="timeline">
            </div>
        </div>
    </body>
    <script>
        


        $(function () {
        const vscode = acquireVsCodeApi();

        $(document).ready(() => {
            vscode.postMessage({ command: 'ready' });
        });


        var fnShowError = function (e) {
            vscode.postMessage({ command: 'debug', data: e});
        }

        var addBox = function(title, status) {
            const div = document.createElement('div');

            div.className = 'row';

            div.innerHTML = `
            <div class="uk-timeline-item">
                <div class="uk-timeline-icon">
                    <span class="uk-badge"><span uk-icon="check"></span></span>
                </div>
                <div class="uk-timeline-content">
                    <div class="uk-card uk-card-default uk-margin-medium-bottom uk-overflow-auto">
                        <section class="uk-sticky-card-wrapper">
                        <div class="uk-sticky-card-header">
                            <div class="uk-grid-small uk-flex-middle uk-sticky-card-header-data" uk-grid>
                                <h3 class="uk-card-title">${title}</h3>
                                <span class="uk-label uk-label-warning uk-margin-auto-left">${status}</span>
                            </div>
                        </div>
                        </section>
                        <div class="uk-card-body" name="timeline-log">
                        </div>
                    </div>
                </div>
            </div>
            `;

            document.getElementById('timeline').appendChild(div);
        }

        var addLog = function(log) {
            var para = document.createElement("P");               // Create a <p> element
            para.innerText = log;               // Insert text
            //document.getElementsByName('timeline-body').appendChild(para);

            var nodes = document.querySelectorAll("[name='timeline-log']:last-child");
            var node = nodes[nodes.length - 1];
            node.appendChild(para);
        }
        
        // Handle the message inside the webview
        window.addEventListener('message', event => {
            const message = event.data;
            switch (message.command) {
                case 'done':
                    break;
                case 'addBox':
                    var title = message.data.title;
                    var status = message.data.status;

                    addBox(title, status);
                    break;
                case 'addLog':
                    var log = message.data.log;
                    addLog(log);
                    break;
            }
        });
    })

        </script>
</html>




